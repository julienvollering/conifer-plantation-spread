---
title: 'Confounders obscure large and idiosyncratic differences between ecosystems in vulnerability to alien conifer establishment'
author:
- Julien Vollering^[julienvollering@gmail.com]
- et al.
bibliography: invasibility-ms.bib
output: 
  bookdown::html_document2:
    toc: true
    toc_float: true
always_allow_html: true
editor_options:
  chunk_output_type: console
link-citations: yes
csl: ecology.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, tidy=TRUE, tidy.opts = list(width.cutoff=60))
options(knitr.graphics.auto_pdf = TRUE)
library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
```

# ORCIDs

Julien Vollering: <https://orcid.org/0000-0002-7409-2898>

# Abstract

1. Plantations of alien conifer species are common worldwide, and set to become even more prevalent in coming decades. The rate at which their offspring colonize surroundings varies among similar plantations, and the reasons for this variation are often unclear. To curb the spread of so-called "wildlings" and minimize the burden of valued conifer plantations on native ecosystems, managers need to know which places and ecosystems are most and least vulnerable.
2. We compare how likely wildlings are to establish across a wide range of ecosystem types, focusing on four groups of alien conifer species planted in Norway. We use data from detailed surveys around 82 plantations to model the relationship between ecosystem type and wildling abundance --- accounting for seed rain, climate, and other sources of variation between sites. Further, we check whether differences in vulnerability between individual ecosystem types can be generalized based on broad, shared characteristics.
3. We found that the four groups of conifer species showed somewhat similar patterns of establishment likelihood across ecosystem types, with intensively farmed ecosystem types repeatedly among the least vulnerable. However, broad hydrological and disturbance characteristics of ecosystem types did not summarize patterns of vulnerability well. 
4. Wildlings were several orders of magnitude more likely to establish in the most vulnerable ecosystem types than in the least vulnerable ecosystem types. This range of variation was larger than that of observed wildling densities across ecosystem types. Accounting for seed rain, climate, and site variation also changed the rank vulnerabilities of ecosystem types. 
6. *Synthesis and applications* Efforts to keep alien conifers within plantation boundaries have the opportunity to exploit large differences in wildling establishment between ecosystem types. To do so effectively, managers need to be aware that the relative density of wildlings observed in a given ecosystem type (or other management unit) does not generally reflect that ecosystem's relative vulnerability, since confounders obscure this relationship. Nor should managers assume that ostensibly similar ecosystems are similarly vulnerable. A careful accounting of variation in wildling spread gives us the knowledge to restrict new plantations to low-risk sites and to make monitoring and intervention more efficient.

# Keywords

conifer, disturbance, invasibility, plantation, seed rain, Wald Analytical Long-distance Dispersal (WALD)

# Introduction

Plantations of alien conifers are widespread globally, and offspring from these plantations frequently establish in surrounding areas [@richardsonConifersInvasiveAliens2004].
In many instances these naturalized offspring, or wildlings, harm biodiversity and other values, so controlling their spread is prudent.
In particular, plantations contribute to the presence of alien conifers in protected areas, and generate substantial costs as a result [@mcconnachieEstimatingEffectPlantations2015].
Controlling wildlings protects plantation surroundings and prevents secondary, potentially invasive spread.
Accordingly, guidelines for sustainable use of alien trees stress that containing them to the areas set aside for their cultivation is fundamental to good forestry practice [@brunduGlobalGuidelinesSustainable2020].

How many wildlings are present and how far they are from the plantation varies a lot from site to site, even among conspecific plantations of similar age [@fernandesWhatDrivesEucalyptus2018; @nygaardSpreadIntroducedSitka2017], which makes it harder to predict and manage their spread.
To begin to understand this variation, we need to consider both dispersal and establishment (where establishment comprises germination and survival).
These jointly generate patterns of wildling abundance and spatial distribution.
Dispersal at a given site is affected by conditions governing a species' dispersal syndrome --- for instance wind exposure and site topography, in the case of a wind-dispersed species.
Likewise, establishment is affected by biotic and abiotic conditions where seeds arrive.
In theory, conditions inhibiting either process may be exploited to suppress wildling spread.

Reducing establishment is of particular interest because it directly regulates wildling abundance (by comparison, reducing dispersal may regulate wildling abundance through negative density dependence). 
The conditions affecting establishment are also generally easier to manipulate than those affecting dispersal, either directly through intervention or indirectly through site selection [@calvino-cancelaInvasivePotentialEucalyptus2013].
The question, then, becomes: how can we identify establishment-inhibiting conditions in a manner applicable to plantation management?

In Norway --- and similarly in other countries --- there exists a national land mapping classification system that sorts variation in local ecological conditions [@NatureTypesNorway2018].
It is a working tool for land management in Norway, with government backing.
The system builds on the continuum concept [@austinContinuumConceptOrdination1985], aiming for reproducible and value-neutral classification of ecosystems by rule-based discretization of species turnover along important environmental gradients [@whittakerGradientAnalysisVegetation1967; @halvorsenNaturNorgeNiN2015].
As a result, it encapsulates in its ecosystem types much of the variation that is most likely to regulate wildling germination and survival --- in competition, nutrient availability, disturbance, and the like [@richardsonNaturalizationIntroducedPlants2012].
It also identifies broad similarities between ecosystem types, which might be used to tease out generic trends in establishment likelihood.

To estimate how likely wildlings are to establish in particular ecosystem types based on observations of their abundance around a sample of plantations, we must account for (1) seed dispersal, and (2) sources of variation in establishment beside ecosystem type.
For example, low establishment likelihood in an ecosystem type frequently located close to plantations can be masked by copious seed rain [@rougetInferringProcessPattern2003].
Likewise, an ecosystem type may appear to promote establishment if it tends to co-occur with climatic conditions that support germination.
Unconfounded establishment likelihoods can then be used to predict how vulnerable the surroundings of an unobserved plantation are, based on its composition of ecosystem types.
  
Determining which ecosystems are most vulnerable so that interventions can be prioritized objectively is among the most urgent objectives for invasion science [@pysekScientistsWarningInvasive2020].
Plantations of wind-dispersed, alien conifers present a golden opportunity to assess ecosystem invasibility (to these species, @hegerPredictingBiologicalInvasions2003), because we can estimate ecosystem exposure (seed rain) directly, rather than by proxy [@catfordQuantifyingLevelsBiological2012]. 
We examine plantations in Norway to investigate the following questions:  

1. In which ecosystem types are wildlings of alien conifers most and least likely to establish?  
2. How do estimates of establishment likelihood differ from observed wildling densities?
3. Can overarching characteristics of ecosystem types be used to generalize patterns of wildling establishment?  

# Methods

## Field data

We observed wildlings and ecosystem types around 82 plantations across Norway, comprising four groups of alien conifers (hereafter: "species"; fig. \@ref(fig:sites-map)).
The sample contained (1) forty-two sites with Sitka spruce (*Picea sitchensis*) or its fertile hybrid, Lutz spruce (*Picea* x *lutzii*), (2) nineteen with Norway spruce (*Picea abies*), (3) fifteen with undetermined larches (*Larix* spp.), and (4) six with lodgepole pine (*Pinus contorta*).
Note that the plantations of Norway spruce were located in parts of Norway where it is not considered native [@aarrestadForeignNorwaySpruce2014].
We selected and delineated plantations manually --- using aerial imagery --- aiming for plantations that were isolated from other plantations of the same species.
Only plantations with cone-bearing individuals were included in the sample.
We collected field data from each plantation in one of six field campaigns during the period 2016-2019 [reported in @olsenKartleggingAvKortdistansespredning2016; @appelgrenKartleggingAvKortdistansespredning2017; @kyrkjeeideKartleggingAvKortdistansespredning2017; @appelgrenKartleggingAvKortdistansespredning2018; @olsenKartleggingAvKortdistansespredning2019; @sandvenKartleggingAvKortdistansespredning2019].

```{r sites-map, fig.cap='Locations of the 82 plantations in the data set.'}
knitr::include_graphics('figures/sites-map.svg')
```

In the field, wildlings and ecosystem types were mapped comprehensively within a 500x500 m plot centered around the plantation of interest.
Except in the 2016 field campaign, we also mapped as polygons any additional plantations of the same species within a larger 2x2 km plot.
We used GPS to register the point-positions of all wildlings over 30 cm in height, recording a single position for groups of wildlings occurring with less than 5 m between them.
A few exceptionally dense groups of wildlings were mapped by registering polygons instead of points and estimating the number of individuals by transect counts.
Concurrently, we registered polygons for all terrestrial ecosystem types, following the Nature in Norway classification system [version 2.0 or 2.1, @halvorsenNaturNorgeNiN2015].
The Nature in Norway system is the national standard for land cover mapping and provides full spatial coverage (i.e. any location and any kind of land cover is assignable to an ecosystem type).
We mapped ecosystem types at a scale of 1:5000, which implies that all polygons with a size over 250 m^2^ were registered [@brynVeilederKartleggingAv2015].
Regularly patterned occurrence of more than one ecosystem type in polygons smaller than the minimum size were registered as so-called mosaic polygons.

Some non-spatial data were also collected for each of the central plantations. 
We measured the height of a representative individual in the plantation by clinometer.
We also estimated the age of the plantation at the time of the field campaign, either by contacting land owners or municipal officials, or by counting growth rings.
Details for all 82 plantations are provided in Appendix [A1].

## Seed dispersal

For our second analysis --- isolating the effect of ecosystem type on establishment likelihood --- we needed estimates of the spatial distribution of seed rain within the 500x500 m field plots.
Because conspecific plantations were sometimes located nearby the central plantation, we considered all plantations within a 1 km radius to be potential seed sources.
We used two models of seed dispersal to derive two different estimates of relative seed rain in space.

The first model was an empirical seed dispersal location kernel [@nathanDispersalKernels2012], with parameter estimates generalized from multiple data sets.
Specifically, we selected from Bullock et al. [-@bullockSynthesisEmpiricalPlant2017] the kernel that performed best for wind-adapted seeds from 5-15 m tall trees (an Exponential Power function).
Seventy-two of the 82 plantations in our data set matched this height range better than a taller height range with a different empirical kernel.

The second model was mechanistic, using local wind velocity and direction to parameterize the Wald Analytical Long-distance Dispersal [WALD, @katulMechanisticAnalyticalModels2005] model in different directions from seed sources [following @skarpaasDispersalPatternsDispersal2007].
The WALD model takes the form of an inverse Gaussian distribution whose mean ($\mu$) and shape ($\lambda$) parameters are calculated from physical characteristics of the dispersal system:
$$\mu  = \frac{HU}{F}$$
$$\lambda = \left(\frac{H}{\sigma}\right)^2$$
where $H$ is the seed release height, $U$ is the mean horizontal wind velocity between $H$ and the ground, $F$ is the terminal velocity of the seed, and $\sigma$ is a wind turbulence parameter.
We set $H$ to the height of the central plantation, estimated $U$ from a computed vertical wind profile, obtained $F$ from literature (Appendix [A2]), and calculated $\sigma$ from an equation for turbulent flow as a function of vegetation height [@skarpaasDispersalPatternsDispersal2007, eq. A4].
We parameterized separate WALD models for 20º sectors around each seed source, to make seed dispersal anisotropic (directional).
In each sector we estimated mean vegetation height based on the composition of mapped ecosystem types (Appendix [A3]).
Simulataneously, we randomly sampled 100 wind velocities in the direction of the sector during the species' dispersal season (Appendix [A2]).
The 100 resulting WALD kernels produced the seed probability density in the sector, and individual sectors were weighed by the frequency of corresponding wind directions (again, during the species' dispersal season).
The wind data were obtained either from the nearest weather station (MET Norway), a 2.5 km resolution interpolated hindcast covering southern Norway [@haakenstad15yearHighResolution2017], or a 10 km resolution hindcast covering all of Norway [@reistadHighresolutionHindcastWind2011; @haakenstadNORA10EIRevisedRegional]. We used weather station data if the station was less than 2.5 or 10 km away (depending on hindcast coverage), or else the highest resolution hindcast.

Both estimates of relative seed rain were expressed on a square grid with a grain of 10 m.
We chose this cell size to be the same order of magnitude as the smallest allowed ecosystem type polygon.
Dispersal kernels were applied to the distance from seed source to grid cell center. 
Field-mapped polygons of seed sources were transformed into hexagonally gridded point sources, with a density of 0.1 m^-2^ for the first model and 0.01 m^-2^ for the second model (to reduce computation time). 
Additional details about how data from different field campaigns were harmonized to model seed dispersal are explained in Appendix [A4].

## Establishment

For our analysis of establishment likelihood, we rasterized wildling occurences and ecosystem types to the same 10 m grid as the seed dispersal models (fig. \@ref(fig:site-example)). 
Rather than assigning a single ecosystem type to each grid cell, we applied fuzzy logic and assigned ecosystem types in proportion to their areal coverage of the cell.
In other words, each ecosystem type was rendered as a separate raster variable with values in the range [0,1].
By allowing cell composition to be mixed, we tried to capture ecotones in the model and avoid using mapped polygon boundaries overconfidently.
Area covered by mosaic polygons was divided evenly among the constituent types.
We excluded the "tree plantation" ecosystem type because some of the field campaigns did not register wildlings when they occurred within this ecosystem type.

```{r site-example, fig.cap='An illustration of one of the 82 plantation sites: Meaasen. The background map shows the surroundings of the plantation, and the 500x500 m plot is overlaid with an aerial photograph. The middle row of panels represents the data as registered in the field (nature type polygons not shown). The top and bottom rows of panels represent selected variables for the 500x500 m plot, as used in the regression model (with a spatial grain of 10 m). Grid cells without data are either seed sources (corresponding to the polygons shown) or tree plantations of other species (such as one along the road).'}
knitr::include_graphics('figures/site-example/site-example.svg')
```

We used a directed acyclical graph (DAG) to diagram causal relationships among the factors we expected to influence the number of wildlings per cell (fig. \@ref(fig:DAG)).
In the DAG, the unmeasured, proximate causes of wildling number --- establishment likelihood and seed rain --- are decendants of variables that we could observe or model.
We included an effect of elevation from plantation on seed rain because neither of our models of seed dispersal capture potential parameter changes induced by uneven terrain [@katulEffectsGentleTopographic2012].
To estimate the causal influence of ecosystem type on wildlings, the DAG dictated that we adjust for site, climate, elevation from plantation, and relative seed rain in our regression model [@textorRobustCausalInference2016; @mcelreathHauntedDAGCausal2020].
We did not need to adjust for plantation age (with site in the model), but we included it as a covariate anyway because it could reduce the unexplained variance associated with the random effect of site, and because our assumed causal structure would allow us to interpret its coefficient as an (unconfounded) total effect on wildling number [@westreichTableFallacyPresenting2013].
Climate entered the regression model as mean annual temperature (Bio1) and precipitation of the coldest quarter (Bio19), at 30-arcsecond resolution, from the CHELSA data product [@kargerClimatologiesHighResolution2017].
We chose these two variables because they showed the strongest correlations with Norwegian vegetation zones and sections [@bakkestuenSteplessModelsRegional2008].
In the lodgepole pine model we used only Bio19 because the two variables were highly correlated (\rho = 0.98).
Elevation from plantation was taken with respect to the highest point of the central plantation, from digital elevation models at 1 or 10 m resolution (Norwegian Mapping Authority).
Lastly, plantation surroundings are likely to experience large stochastic variation in annual seed rain, because seed release will concide with different wind conditions from year to year.
Therefore we also included in our model the first order interaction between relative seed rain and plantation age.

```{r DAG, fig.cap="A directed acyclical graph showing the causal relationships motivating our statistical model of ecosystems' effects on wildling establishment. Red variables causally affect both the ecosystem type and wildling establishment, blue variables causally affect only wildling establishment, and grey variables are unobserved. Green arrows show the causal pathway of interest."}
knitr::include_graphics(here('ms', 'figures', 'dagitty-model.svg'))
```

For all species, the number of wildlings per cell showed a high frequency of zeros that was underestimated by the best fitting negative binomial distribution.
Accordingly, we applied zero-inflated, negative binomial (ZINB) generalized linear models.
These regard zeros as the mixed product of a binomial process as well as a (conditional) count process.
We modeled the binomial process as dependent on plantation age and site. 
We expected that younger plantations would exhibit more cells without wildlings than predicted under a constant rate of colonization, because of their infertile juvenile period.
We also expected the frequency of zeros to vary with site, because our field work documented that some land owners had occasionally made efforts to remove wildlings.
Excess zeros that arose in these ways would therefore not bias our estimates of establishment likelihood [@blasco-morenoWhatDoesZero2019].
To summarize, we modeled:

\begin{equation}
wildings_{ij} \sim ZINB(\pi_{ij}, \mu_{ij}, \phi) \\
logit(\pi_{ij}) = PlantationAge_{ij} + Site_{ij} \\
log(\mu_{ij}) =  + \sum\limits_{k=1}^K EcosystemType_{ijk} + Site_{i} + Bio1_{ij} + Bio19_{ij} + RelativeElevation_{ij} + \\
RelativeSeedRain_{ij} + PlantationAge_{ij} + RelativeSeedRain_{ij} \cdot PlantationAge_{ij}  \\
Site_{i} \sim Normal(0, \sigma^2) \\
(\#eq:statmod)
\end{equation}

where $\pi$ is the probability of a zero from the binomial process, while $\mu$ and $\phi$ are the mean and dispersion of the negative binomial distribution, respectively [eq. 11.21 in @zuurZeroTruncatedZeroInflatedModels2009]. 
Subscripts $i$, $j$, and $k$ index sites, cells, and ecosystem types.

We standardized variables (except ecosystem types, which were [0,1]) and fitted models with the glmmTMB package [version 1.0, @brooksGlmmTMBBalancesSpeed2017] in R [version 3.6, @rcoreteamLanguageEnvironmentStatistical2020].
For each species we dropped ecosystem types that were completely free of wildlings (to avoid model convergence issues stemming from complete separation).
We fitted parallel models for our two seed rain variables (derived from empirical or WALD dispersal kernels) and selected the model with the better AIC.
To catch problems with our model specification, we looked for deviation from uniformity in quantile-scaled, simulated residuals, using the DHARMa package [version 0.2.7, @hartigDHARMaResidualDiagnostics2020].
We also ran DHARMa's tests for residual over/underdispersion and zero-inflation.
The Norway spruce model showed residual underdispersion, so we replaced the negative binomial distribution with the generalized Poisson distribution, which solved the issue [@brooksStatisticalModelingPatterns2019].
Furthermore, the lodgepole pine model did not converge as specified.
To achieve convergence we dropped site from the binomial submodel, reasoning that its variance was difficult to estimate from only six sites.
Finally, establishment likelihoods for ecosystem types were calculated as predictions from the conditional part of the zero-inflation model (holding covariates at their mean values), scaled by the predicted value for "forests".

To check how the covarates in our models swayed estimates of establishment likelihood, we calculated the raw density of wildlings in each ecosystem type (abundance/area).
To facilitate comparison, we derived these densities from the same gridded data set used to train the models, tallying wildlings in proportion to the ecosystem type composition of the grid cells they occupied. 
For example, a cell occupied by one wildling and half its area covered by a given ecosystem type would tally 0.5 wildling for that ecosystem type.

To test whether higher-level characteristics of ecosystem types can be used to generalize patterns of vulnerability, we aggregated ecosystem types by their category (terrestrial or wetland) or structuring process (anthrogenic, natural or no disturbance), as defined in the Nature in Norway system (Appendix [A3]).
We then refitted our (otherwise unchanged) models twice --- once with each of these stratifications replacing ecosystem types --- and obtained estimates of relative establishment likelihood for each category and structuring process.

# Results

Modeled establishment likelihoods varied by up to five orders of magnitude (fig. \@ref(fig:establishment)).
The pattern of establishment likelihood among ecosystem types was modestly similar between species, with positive rank correlations in four of six species pairs (tab. \@ref(tab:correlation-table)).

```{r establishment, fig.cap="Relative densities (unfilled points) and relative establishment likelihoods (filled points) of four alien conifer species groups in various ecosystem types, using 'forest' as the reference level. Zero density is plotted at the lower limit of the x-axis. Estimates of relative establishment likelihood are shown with 95 % confidence intervals. Grey point clouds depict relative establishment likelihoods for individual sites in our data set. The order of ecosystem types along the y-axis is determined by a confidence-weighted mean of their percentile-ranked establishment likelihoods within species, such that types with consistently high establishment likelihood across species are at the top. Ecosystem types in italic font are wetlands, and ecosystem types in bold font are structured by disturbance. Ecosystem types without wildlings and covering less than 0.5 ha across all sites for that species are not displayed. Photos licensed CC BY 4.0 Rune Halvorsen."}
knitr::include_graphics(here('ms', 'figures', 'establishment', 'establishment.svg'))
```

```{r correlation-table}
cortab <- read.csv(here('ms', 'tables', 'spearman-corr.csv'), 
                   row.names = 1, check.names = FALSE)
cortab[lower.tri(cortab, diag = TRUE)] <- ""
cortab <- cortab[-4,-1]
knitr::kable(cortab, 
             caption = "Rank correlations of establishment likelihoods in ecosystem types, between pairs of species.") %>%
  kable_styling(full_width = F)
```

Relative establishment likelihoods varied more than the corresponding set of raw densities, in all species (fig. \@ref(fig:establishment)).
Raw densities across all ecosystem types ranged 0-211/ha for Sitka spruce, 0-49/ha for Norway spruce, 0-1045/ha for larch, and 0-219/ha for lodgepole pine.
For all species, the WALD seed dispersal model produced seed rain values that predicted wildling establishment better than the values derived from the empirical seed dispersal kernel (Appendix [A5]).
The direct effect of relative elevation on establishment --- not including its effect mediated by ecosystem types --- was modest and acted in different directions for different species.
Plantation age effects were estimated near zero in all cases except in the binomial submodels for Sitka/Lutz spruce and larch (where older plantations showed fewer zeros).
The interaction specified between relative seed rain and plantation age showed inconsistent effects.
The direct effect of climate on establishment --- not including its effect mediated by ecosystem types --- was negligible for Sitka/Lutz spruce and Norway spruce. 
For larch there was a negative direct effect of precipitation (Bio19), with a 50 mm increase in coldest-quarter precipitation estimated to decrease establishment six-fold.
Likewise for lodgepole pine, the model estimated a 175 mm increase in coldest-quarter precipitation to decrease establishment by a factor of 50.
For Sitka/Lutz spruce and lodgepole pine, establishment likelihood varied strongly between sites, such that it swamped much of the variation between ecosystem types.

Variation in establishment likelihoods shrank when ecosystem types were aggregated (by category or structuring process; fig. \@ref(fig:establishment-hypotheses)).
No more than two orders of magnitude separated the different groups.
Sitka/Lutz spruce and Norway spruce established at higher rates in wetland ecosystem types than terrestial ecosystem types, while the opposite was true for larch and lodgepole pine.
Sitka/Lutz spruce and Norway spruce did not generally colonize disturbance-structured ecosystem types at higher rates than ecosystem types without disturbance structuring.
For larch and lodgepole pine, structuring by natural distubance and anthropogenic disturbance, respectively, were associated with the highest rates of colonization. 
Yet despite larger sample sizes, the mean establishment likelihood in any particular group was rarely clearly distinguishable from that in other groups.

```{r establishment-hypotheses, fig.cap="Establishment likelihoods among categories of ecosystem types (top) or structuring processes in ecosystem types (bottom), for four alien conifer species groups. Unfilled points show scaled wildling densities calculated directly from the data. Filled points with line intervals show modeled estimates surrounded by their 95 % confidence intervals. The scale of the x-axis differs by species group and the horizontal dotted line marks the reference level for the comparison."}
knitr::include_graphics(here('ms', 'figures', 'establishment-hypotheses.svg'))
```

# Discussion

## Ecosystem vulnerability

In a large database of vegetation plots across Europe, Chytrý et al.[-@chytryHabitatInvasionsAlien2008] found that alien plants as a group are consistently found at low rates in mires and heaths, and high rates in arable, man-made, and coastal ecosystem types.
The conifer species we examined --- perhaps with the exception of lodgepole pine --- did not conform to these broader trends in ecosystem invasibility.
Lodgepole pine establishment is relatively well studied, and our results seem consistent with this literature.
"Bare rock" harbors very few competitors and showed highest lodgepole pine establishment of all ecosystem types [@despainDispersalEcologyLodgepole2001], "coastal heath" (a short shrubland) facilitated more establishment than grassland-like ecosystems [@taylorDriversPlantInvasion2016], all ecosystem types with canopy cover were among those with lowest establishment [@langdonPinusContortaInvasion2010; @taylorDriversPlantInvasion2016], and ecosystem types with high establishment were frequently structured by anthropogenic disturbance [@richardsonPineInvasionsSouthern1994].

It is difficult to evaluate our ecosystem invasibility results against the recruitment patterns that have been described for the three other species.
For instance, Sitka spruce grows poorly under moisture stress and tolerates flooding well [@petersonEcologyManagementSitka1997], which might account for why it was twice as likely to establish in wetland ecosystems as in terrestrial ecosystems.
Yet it also established in "open shallow-soil ground" with very high likelihood, despite this ecosystem type's characteristically dry soil. 
This illustrates the trouble with deriving predictions for management units such as ecosystem types from generalized statements about species autecology; should we expect few wildlings in "open shallow-soil ground" because it is dry, or many because it provides ample light and reduced competition [@petersonEcologyManagementSitka1997]?
Furthermore, ecosystem types that would seem inhospitible based on their overall characteristics may actually contain many localized opportunities for establishment, because seedling mortality is strongly regulated by microsites [@macekLifeDeathPicea2017].
From this perspective, our estimates of establishment likelihood measure the density of suitable microsites in a given ecosystem type.

The breadth of establishment likelihoods we found suggests that differences between ecosystem types deserve careful consideration when managing wildling spread.
This knowledge can be applied in at least two ways.
First, as a preventative measure, we recommend siting new plantations where surrounded by high proportions of ecosystem types with low establishment likelihood.
In particular, "arable fields" harbor very few wildlings of any species and are common near existing plantations, so picking sites hemmed in by this kind of agricultural land should be both effective and feasible.
This would likely reduce the rate of wildling establishment by orders of magnitude, even if long distance dispersal might preclude complete containment [@albertLanduseChangeSubalpine2008]. 
In some cases it may also be desireable to alter ecosystem types adjacent to existing plantations to prevent (further) spread, for example by intensifying mowing regimes to promote the appearance of "agriculturally improved grassland".
Second, as a reactive measure, we recommend allocating resources for monitoring and control in proportion to relative ecosystem vulnerability.
Prioritizing ecosystem types that are highly vulnerable and also rare (e.g. "open active landslide") is especially likely to be cost-efficient. 

The establishment patterns we quantify are likely to hold, more or less, beyond Norway [@chytryHabitatInvasionsAlien2008].
From a manager's perspective, we expect that the ecosystem types we report may translate well to equivalent types in similar classification systems, because the Nature in Norway classification is rule-based and aims for observer neutrality. 
At the same time, we urge caution in extending our establishment estimates to ecosystems that are only broadly similar, because we found that similar types frequently showed markedly different invasibility (e.g. Norway spruce in "agriculturally improved grassland with semi-natural character" vs. "agriculturally improved grassland").

An observational study like ours informs management of long-lived, naturalized species more directly than experimental studies, because longer time frames are examined.
It measures long-term survival --- often the quantity of interest --- under a wide range of natural conditions experienced by the wildlings.
In contrast, seeding experiments generally observe only the youngest life stages, and the factors controlling individual success likely differ at later life stages [@dovciakSeedRainEnvironmental2008].
For example, Sitka spruce appears more likely to germinate in disturbed soil [@vikaneInvasionCallunaHeath2013], but less likely to survive there [@petersonEcologyManagementSitka1997].
On the other hand, experiments might be more useful when observed wildling spread is not representative of patterns in the wider landscape (e.g. for species spreading from a single point of introduction).
During field work we noticed that wildlings in different ecosystem types sometimes grew taller at very different rates, as evidenced by interwhorl distances, and additional insight could be gleaned from a study like ours if (a sample of) growth rates were measured.
Sparse but fast colonization may be of greater concern than abundant but slow colonization, depending on management objectives.

## Estimating vulnerability

Confounders of the relationship between ecosystem type and wildling abundance caused differences between ecosystem types to be underestimated. 
This implies that confounding variables counteracted differences in ecosystem establishment in our sample, for instance that vulnerable ecosystems were concentrated at sites predicted to show limited spread.
We caution, therefore, that direct inference from observations of wildling abundance misguides intuition about relative ecosystem vulnerability.
For example, the raw density of Sitka spruce wildlings was about equal in "boreal heath" and "sand dunes", but we estimate that establishment likelihood is actually about 100 times larger in "boreal heath".

The effect size of WALD-modeled relative seed rain was estimated close to one for all species except Norway spruce, which indicates that spatial patterns of wildling abundance around plantations were captured satisfactorily by this variable.
We take this as evidence that the WALD model describes seed dispersal well in our system, but recognize that survivorship bias prevents rigorous assessment of this relationship with our data.
For example, the Exponential Power model we tested generally showed a steeper decline in seed rain away from seed sources than the WALD model, so negative density dependence in seedling survival could skew the spatial distribution of wildling abundance towards the WALD model, even if the Exponential Power model describes seed dispersal better.
That this important covariate was modeled and not measured is a limitation of our method, and it makes the establishment likelihoods we estimate less certain.
Nevertheless, the mechanistic nature of the WALD model makes us more confident in its estimates across species and sites than we would be in a purely phenomenological model [@bullockAllDispersalFunctions2018]. 

Relative elevation's inconsistent effects on wildling abundance suggests that either terrain does not strongly affect seed dispersal or --- more likely --- vertical distance alone does a poor job of representing its effect.
In any case, there is no rule of thumb for management that wildlings tend to move up or down slopes.
Surprisingly, wildling abundance did not increase with plantation age, although areas around younger plantations were generally more likely to be free of wildlings.
Potential explanations include lower survival rates in older wildlings, or a quick saturation of suitable microsites.
Meanwhile, negative interactions between relative seed rain and plantation age (in larch and lodgepole pine) could theoretically be explained by secondary seed production, which changes the shape of the seed shadow as the plantation grows older, but we observed little indication of significant seed production from wildings in the field.

We reiterate that our models do not estimate the total causal effect of climate on wildling abundance, because they set aside climate's influence on ecosystem types [@westreichTableFallacyPresenting2013].
Therefore, we interpret the estimated climate effects with respect to physiological contraints within a given ecosystem type. 
The lack of a direct climate effect on Sitka/Lutz spruce wildling abundance is consistent with Sitka spruce's wide climatic tolerance relative to climatic variation in Norway [@petersonEcologyManagementSitka1997; @volleringBunchingBackgroundBetters2019, Appendix F].
Norway spruce seedling recruitment has previously been found to increase towards the wetter end of Norwegian climate [@tingstadTemperaturePrecipitationBiotic2015], but most of our Norway spruce sites circumscribed a narrow part of that range.
We are not confident that lodgepole pine responds strongly to precipitation, as estimated, because the sample contained only six sites from two climates.

A curious feature of our results that needs more research is the large amount of unexplained variation in Sitka/Lutz spruce and lodgepole pine establishment likelihood between sites.
Our ability to predict these species' magnitude of spread at a specific site, relative to other sites, is still limited. 
Ecosystem comparisons can nevertheless guide management.
For example, a particular site with "arable field" may well be colonized by Sitka/Lutz spruce as quickly as another site with "coastal heath", but knowing only their ecosystem composition, we expect the latter to be colonized more than 100 times faster.
Bianchi et al. [-@bianchiMethodsPredictingSitka2019] struggled to predict regeneration density within Sitka spruce plantations from bare ground cover, moss cover, plantation age, and plantation density.
The inadequacy of plantation density as a predictor in this context suggests that the unexplained site-level variation we observed was not caused by differences in the densities of seed sources (which we assumed to be constant).
Alternative explanations could include: property owners removing wildlings at some sites or differing demographic characteristics among plantations [@taylorDriversPlantInvasion2016], potentially as a result of provenance. 

## Generalizing vulnerability

The overarching characteristics that we used to aggregate ecosystem types did a poor job of generalizing differences in vulnerability.
That is, groups of ecosystems belonging to the same hydrological category, or structured by the same form of disturbance, showed heterogeneous establishment likelihoods.
We note that slightly different sets of ecosystem types comprised the groups for each species, depending on their presence in the data.
These differences in ecosystem composition help explain why the patterns of aggregated establishment likelihood varied between species. 
For example, Sitka/Lutz spruce and larch show high establishment under natural disturbance structuring partly because they establish well in "open active landslide", but this ecosystem type was not present for the other species. 
This constraint hinders species comparisons but underlines our main takeaway from these results --- that the vulnerability of an individual ecosystem type frequently diverges from those it is classified with.
Thus, we did not find any broad commonalities between vulnerable ecosystems that could help guide wildling management where data are scarce. 

Within species, we urge careful interpretation of the comparisons among ecosystem categories and structuring processes.
Many areas where conifer establishment is nearly impossible, like paved surfaces and annually plowed fields, count as terrestrial and anthropogenically disturbed, which lowers the relative establishment likelihood of these two groups.
Our results do not imply, for example, that any particular anthropogenic disturbance event will decrease establishment likelihood of Sitka/Lutz spruce relative to an ecosystem's prior state (indeed, Vikane et al. [-@vikaneInvasionCallunaHeath2013] show that burning in coastal heathland increases Sitka spruce establishment).
Rather, we find that ecosystems structured by anthropogenic distubance, on the whole, are no more vulnerable to Sitka/Lutz spruce wildlings than other ecosystems.

# Conclusions

Wildling spread from plantations is a growing problem [@richardsonConifersInvasiveAliens2004] and is likely to accelerate with recent pushes to increase tree planting worldwide [@brunduGlobalGuidelinesSustainable2020]. 
Meanwhile, remotely sensed and survey data are making detailed and accurate maps of ecosystem types increasingly available over large extents [@horvathDistributionModellingVegetation2019], which presents opportunities to manage wildling spread more efficiently [@buckleySlowingPineInvasion2005].
Specifically, differences in ecosystem invasibility can be leveraged to 
reduce the rate of wildling establishment (potentially by orders of magnitude) through deliberate site selection for new plantations or targeted interventions around existing plantations.
However, managers should be cautious judging ecosystem invasibility based on descriptions of the species' autecology, observed wildling densities, or generalizations about invasibility across ecosystem types.

One of main novelties of this study is that we inferred invasibility using mechanistically reconstructed, spatial estimates of seed rain.
Scientists studying invasibility at national and continental scales have already recognized the importance of normalizing observed levels of invasion by a spatially explicit estimate of exposure (i.e. propagule pressure) [@chytrySeparatingHabitatInvasibility2008]. 
However, many studies quantifying ecosystem invasibility have not been able adjust for propagule pressure, typically because it is impossible to reconstruct the underlying dispersal history [@catfordQuantifyingLevelsBiological2012].
We found that accounting for seed rain and other confounders of the relationship between ecosystem types and wildling abundance underlined variation in ecosystem type invasibility.

# Appendix

## A1

```{r load sites-table, include=FALSE}
locs <- read_csv(here('output', 'localities-modified.csv')) # see 'wildlings-NiN.Rmd'
locs <- locs %>% 
  select(year.registered, reference, species, 
         locality, utm33.easting, utm33.northing,
         height.source, age, bio01, bio19,
         height.interpolated, age.interpolated) %>% 
  arrange(year.registered, reference, species) %>% 
  select(-year.registered)
# Formating
locs <- locs %>% 
  mutate(species = case_when(
    species == "P.contorta" ~ "Pinus contorta",
    species == "P.sitchensis-lutzii" ~ "Picea sitchensis / lutzii",
    species == "P.abies" ~ "Picea abies",
    species == "Larix" ~ "Larix spp.")) %>% 
  mutate(locality = paste(toupper(substring(locality, 1, 1)), 
                          substring(locality, 2), sep = ""),
             .before = utm33.easting) %>%
  mutate_at(c("utm33.easting","utm33.northing"), round) %>% 
  mutate_at(c("bio01","bio19"), ~ round(./10, digits = 2)) %>% 
  rename(`species group` = species, site = locality, easting = utm33.easting, 
         northing = utm33.northing, height = height.source)
# Footnotes
names(locs)[8] <- paste0(names(locs)[8], footnote_marker_alphabet(1))
names(locs)[9] <- paste0(names(locs)[9], footnote_marker_alphabet(2))
locs <- locs %>% 
  mutate_at(c("height","age"), as.character) %>% 
  mutate(height = case_when(
    height.interpolated ~ paste0(height, footnote_marker_symbol(1)),
    TRUE ~ height)) %>% 
  mutate(age = case_when(
    age.interpolated ~ paste0(age, footnote_marker_symbol(2)),
    TRUE ~ age)) %>% 
  select(-height.interpolated, -age.interpolated)
```

```{r sites-table}
kable(locs, escape = FALSE, align = "lllrrrrrr") %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(2, italic = TRUE) %>%
  footnote(general = "Easting and Northing are given for UTM zone 33N. Height is given in meters and age in years.",
           alphabet = c("mean annual temperature (°C)",
                        "precipitation in coldest quarter (cm)"),
           symbol = c("interpolated as the mean height of other plantations of the same species, inversely weighted by difference in age",
                      "interpolated as the mean age of other plantations of the same species in the same region"))
```

## A2

```{r recreate traits-table, include=FALSE}
traits <- tribble(
  ~`species group`, ~`seed terminal velocity`, ~`dispersal season`, ~references,
  "Larix spp.", 1.0, "Dec - May", "2, 3",
  "Picea abies", 0.58, "Nov - May", "2, 4",
  "Pinus contorta", 0.82, "Sep - Dec", "2",
  "Picea sitchensis / lutzii", 0.94, "Oct - Feb", "1, 2")
```

```{r traits-table}
kable(traits, escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(1, italic = TRUE) %>%
  footnote(general = c("1. Harris, A. S. Sitka spruce. in Silvics of North America: 1. Conifers (eds. Burns, R. M. & Honkala, B. H.) vol. 2 513–529 (U.S. Department of Agriculture, Forest Service, 1990).",
                       "2. Sandvik, H. Kunnskapsstatus for spredning og effekter av fremmede bartrær på biologisk mangfold. (2012).",
                       "3. Sullivan, J. Larix decidua. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/lardec/all.html (1994).",
                       "4. Sullivan, J. Picea abies. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/picabi/all.html (1994)."), 
            general_title = "References: ")
```

## A3

```{r make types table, include=FALSE}
pairing <- read_csv(here('data','codetype-pairing.csv'))
types <- read_csv(here('data', 'types.csv'))
typestab <- inner_join(types, pairing) %>%
  filter(!grepl(pattern = '.', x = .data$code, fixed = TRUE)) %>% 
  select(type = name, code, category, structuring, `vegetation height` = vegheight)
# Footnotes
names(typestab)[5] <- paste0(names(typestab)[5], footnote_marker_alphabet(1))
```

```{r types table}
options(knitr.kable.NA = '')
kable(typestab, escape = FALSE) %>% 
  collapse_rows(columns = 1) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  footnote(alphabet = "approximate vegetation heights (meters) are used only to estimate wind turbulence")
```

## A4

Seed source polygons for which the species of interest only made up a fraction of the plantation composition [e.g. in @olsenKartleggingAvKortdistansespredning2019] were used with their point source density adjusted accordingly.
For example, a plantation identified as composed of Sitka spruce and Norway spruce was assigned a seed source point density half that of a pure Sitka spruce plantation.
Likewise, 'mixed forest' plantations [e.g. in @appelgrenKartleggingAvKortdistansespredning2018] were assigned 0.1 times the seed source point density of a pure plantation.  
Seed source polygons identified as logged [e.g. in @appelgrenKartleggingAvKortdistansespredning2018] were included as seed sources only if we could confirm that they were logged no earlier the decade prior to mapping, using time series of aerial photos.

## A5

```{r, message=FALSE}
msumms <- list.files(here('ms', 'tables'), pattern = "summary", full.names = TRUE) %>% 
  set_names(~ tools::file_path_sans_ext(basename(.))) %>% 
  map(read_csv) %>% 
  map(~ mutate(., Term = if_else(Term == "locality", "site", Term)))
```

```{r}
kable(msumms$`Ps-modelsummary`, align = 'clrrrr', caption = "Picea sitchensis / lutzii. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.253.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(msumms$`Pa-modelsummary`, align = 'clrrrr', caption = "Picea abies. Conditional model is glmmTMB's genpois family with dispersion parameter 2.59.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(msumms$`L-modelsummary`, align = 'clrrrr', caption = "Larix. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.261.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(msumms$`Pc-modelsummary`, align = 'clrrrr', caption = "Pinus contorta. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.0269.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")
```

# References

```{r sessionInfo}
capture.output(sessionInfo(), file="sessionInfo.txt")
```
