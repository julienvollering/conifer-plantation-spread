---
title: 'Alien conifer spread in Norway'
author:
- Julien Vollering^[julienvollering@gmail.com]
- et al.
bibliography: invasibility-ms.bib
output: 
  bookdown::html_document2:
    toc: true
    toc_float: true
always_allow_html: true
editor_options:
  chunk_output_type: console
link-citations: yes
csl: ecology.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, tidy=TRUE, tidy.opts = list(width.cutoff=60))
options(knitr.graphics.auto_pdf = TRUE)
library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
```

# ORCIDs

Julien Vollering: <https://orcid.org/0000-0002-7409-2898>

# Running head

Alien conifers in Norway

# Abstract


# Keywords


# Introduction

Plantations of alien conifers are widespread in Norway, as they are in many countries, and offspring from these plantations frequently establish in surrounding areas [@richardsonConifersInvasiveAliens2004].
Around some plantations these naturalized offspring --- or wildlings --- are abundant and distant from the plantation boundary.
Around others there are few or no wildlings [@nygaardNaturligSpredningAv1999].

Depending on how rapidly wildlings spread, their expansion beyond the plantation may be considered invasive. 
Implications for integrity of the ecosystem, especially important for areas of high value, and potentially affecting ecosystem services.
For example, biodiversity, coastal heathland, landscape changes.
As a result, managers are interested in limiting spread from plantations of alien species (compared to natural regeneration of mixed stand forestry)

Norway has only two native conifer species that cover large areas: Scots pine, *Pinus sylvestris* and Norway spruce, *Picea abies*).
As a result, 20th century efforts to increase forest cover relied heavily on alien species [@oyenBiomassPotentialSelected2017]. 

'Invasive' normally applied to species, but differences among plantations of the same species are also observed.

The degree of naturalized spread observed surrounding plantations is highly variable.
Specifically, the number of naturalized individuals, their location with respect to the plantation, and their rate of growth varies. 
Many factors may be hypothesized to affect the degree of naturalized spread: the species in the plantation, the seed production of the plantation, the dispersal capacity of the the seeds, and the establishment rate of the seeds in the surroundings.  

It is important to consider at what spatial scale variability in natural recruitment occurs. This may differ between species. If most variation occurs at the coarsest spatial scale, drivers that also vary at course scales, such as climate, are likely to be important. If variation between plantations is greater than variation between regions, climate and other coarse-scale factors are probably less important, and drivers that vary at the plantation scale are likely important. If more variation occurs around single plantations than between plantations, site characteristics (e.g. surrounding ecosystem types) are likely the most important governing factors. 

Fertile plantations produce highest propagule pressure on their immediate surroundings, because their seeds are (primarily?) wind-dispersed.
Extensive
LDD less important

Managers are interested in limiting or eliminating spread from plantations, especially into areas with high ecological value (protected areas?).
Therefore, the key process that we examine is naturalized spread, which can be broken down into the processes of seed arrival and then germination, growth, and survival (assuming that the seed is viable when it arrives).
Seed arrival depends on dispersal from source populations, and is a fundamentally spatial process. 
Meanwhile, germination, growth, and survival (hereafter: "establishment") depend on the conditions at the arrival location.
To better understand which factors govern naturalized spread, we need to know how seeds are dispersed from plantations, and which landing site conditions promote or inhibit establishment. 

Therefore, the number of wildlings in the surroundings of a plantation is a function of the seed shadow from the plantation and the environmental characteristics of the proximal area.
Note that the seed shadow is not purely a function of plantation characteristics; plantation surroundings also affect the seed shadow.  
For example, lower elevations may trap more seeds.

# Methods

## Approach

We compared the frequency with which four groups of alien conifer species establish in various ecosystem types, using observational data.
Specifically, we used maps of wildlings and ecosystem types around the plantations from which the wildlings likely originated.
The groups of species (hereafter: "species") we examined were: (1) Sitka spruce (*Picea sitchensis*) together with its fertile hybrid, Lutz spruce (*Picea* x *lutzii*), (2) Norway spruce (*Picea abies*), (3) undetermined larches (*Larix* spp.), and (4) lodgepole pine (*Pinus contorta*). 

For each of the species, we analysed establishment frequency in two ways.
Our first analysis simply tallied of the number of wildlings per unit area for each ecosystem type.
The motivation for this naive approach was descriptive; we summarized the state of wildling establishment from the plantations in the sample.
Our second analysis was designed to isolate the influence of ecosystem types on establishment probability.
To do so, we defined establishment probability $E$ as the ratio of wildlings $W$ to deposited seeds $S$ in a given area, or:

\begin{equation} 
W_{xy} 	= S_{xy} * E_{xy}
(\#eq:estmod)
\end{equation}

where xy denotes a unit area.
This simple conceptual model mirrors our basic mechanistic understanding of the spread process: seeds disperse from their source to a given location ($S_{xy}$), and then the conditions at that location ($E_{xy}$) determine the likelihood that the seed establishes as a wildling ($W_{xy}$).
Guided by this equality, we specified a statistical model for the relationship between wildlings and ecosystem types, conditioning on estimates of $S_{xy}$.


## Field data

We observed wildlings and ecosystem types around 82 plantations across Norway (fig. \@ref(fig:localities-map)).
The sample comprised forty-two localities with Sitka/Lutz spruce, nineteen with Norway spruce, fifteen with larch, and six with lodgepole pine.
Note that the plantations of Norway spruce were located in parts of Norway where it is not considered native [@aarrestadForeignNorwaySpruce2014].
We selected and delineated plantations manually --- using aerial imagery --- aiming for plantations that were isolated from other plantations of the same species.
Furthermore, only plantations with cone-bearing individuals were included in the sample.
We collected the field data from each plantation in one of six field campaigns during the period 2016-2019 [reported in @olsenKartleggingAvKortdistansespredning2016; @appelgrenKartleggingAvKortdistansespredning2017; @kyrkjeeideKartleggingAvKortdistansespredning2017; @appelgrenKartleggingAvKortdistansespredning2018; @olsenKartleggingAvKortdistansespredning2019; @sandvenKartleggingAvKortdistansespredning2019].

```{r localities-map, fig.cap='Locations across Norway of the 82 plantations in the data set.'}
knitr::include_graphics('figures/localities-map.pdf')
```

In the field, wildlings and ecosystem types were mapped comprehensively within a 500x500 m plot centered around the plantation of interest.
Except in the 2016 field campaign, we also mapped as polygons any additional plantations of the same species within a larger 2x2 km plot.
We used GPS to register the point-positions of all wildlings over 30 cm in height, recording a single position for groups of wildlings occurring with less than 5 m between them.
A few exceptionally dense groups of wildlings were mapped by registering polygons instead of points and estimating the number of individuals by transect counts.
Concurrently, we registered polygons for all terrestrial ecosystem types following the Nature in Norway classification system [version 2.0 or 2.1, @halvorsenNaturNorgeNiN2015].
The Nature in Norway system is the national standard for land cover mapping and provides full spatial coverage (i.e. any location and any kind of land cover is assignable to an ecosystem type).
It builds on the continuum concept in ecology, aiming for reproducible and value-neutral classification of ecosystems by rule-based discretization of species turnover along important environmental gradients [@austinContinuumConceptOrdination1985; @NatureTypesNorway2018; @whittakerGradientAnalysisVegetation1967].
We mapped ecosystem types at a scale of 1:5000, which implies that all polygons with a size over 250 m^2^ were registered [@brynVeilederKartleggingAv2015].
Regularly patterned occurrence of more than one ecosystem type in polygons smaller than the minimum size were registered as so-called mosaic polygons.

Some non-spatial data were also collected for each of the central plantations. 
We measured the height of a representative individual in the plantation by clinometer.
We also estimated the age of the plantation at the time of the field campaign, either by contacting land owners or municipal officials, or by counting growth rings.
Details for all 82 plantations are provided in Appendix [A1].

## Seed dispersal

For our second analysis --- isolating the effect of ecosystem type on establishment probability --- we needed estimates of the spatial distribution of seed deposition within the 500x500 m field plots.
Because conspecific plantations were sometimes located nearby the central plantation, we considered all plantations within a 1 km radius to be potential seed sources.
We used two models of seed dispersal to derive two different estimates of seed deposition probability density.

The first model was an empirical seed dispersal location kernel [@nathanDispersalKernels2012], with parameter estimates generalized from multiple data sets.
Specifically, we selected from Bullock et al. [-@bullockSynthesisEmpiricalPlant2017] the kernel that performed best for wind-adapted seeds from 5-15 m tall trees (an Exponential Power function).
Seventy-two of the 82 plantations in our data set matched this height range better than a taller height range with a different empirical kernel.

The second model was mechanistic, using local wind velocity and direction to parameterize the Wald Analytical Long-distance Dispersal [WALD, @katulMechanisticAnalyticalModels2005] model in different directions from seed sources [following @skarpaasDispersalPatternsDispersal2007].
The WALD model takes the form of an inverse Gaussian distribution whose mean ($\mu$) and shape ($\lambda$) parameters are calculated from physical characteristics of the dispersal system:
$$\mu  = \frac{HU}{F}$$
$$\lambda = \left(\frac{H}{\sigma}\right)^2$$
where $H$ is the seed release height, $U$ is the mean horizontal wind velocity between $H$ and the ground, $F$ is the terminal velocity of the seed, and $\sigma$ is a wind turbulence parameter.
We set $H$ to the height of the central plantation, estimated $U$ from a computed vertical wind profile, obtained $F$ from literature (Appendix [A2]), and calculated $\sigma$ from an equation for turbulent flow as a function of vegetation height [@skarpaasDispersalPatternsDispersal2007, eq. A4].
We parameterized separate WALD models for 20º sectors around each seed source, to make seed dispersal anisotropic (directional).
In each sector we estimated mean vegetation height based on the composition of mapped ecosystem types (Appendix [A3]).
Simulataneously, we randomly sampled 100 wind velocities in the direction of the sector during the species' dispersal season (Appendix [A2]).
The 100 resulting WALD kernels produced the seed probability density in the sector, and individual sectors were weighed by the frequency of corresponding wind directions (again, during the species' dispersal season).
The wind data were obtained either from the nearest weather station (MET Norway), a 2.5 km resolution interpolated hindcast covering southern Norway [@haakenstad15yearHighResolution2017], or a 10 km resolution hindcast covering all of Norway [@reistadHighresolutionHindcastWind2011; @haakenstadNORA10EIRevisedRegional]. We used weather station data if the station was less than 2.5 or 10 km away (depending on hindcast coverage), or else the highest resolution hindcast.

Both models of seed deposition density were expressed on a grid with a grain of 10 m, so dispersal kernels were applied to the distance from seed source to grid cell center. 
Field-mapped polygons of seed sources were transformed into hexagonally gridded point sources, with a density of 0.1 m^-2^ for the first model and 0.01 m^-2^ for the second model (to reduce computation time). 
Additional details about how data from different field campaigns were harmonized to model seed dispersal are explained in Appendix [A4].

## Establishment

For our analyses of establishment, we rasterized wildling occurences and ecosystem types to the same 10 m grid as the seed dispersal models (fig. \@ref(fig:locality-example)). 
Rather than assigning a single ecosystem type to each grid cell, we applied fuzzy logic and assigned ecosystem types in proportion to their areal coverage of the cell.
In other words, each ecosystem type was rendered as a separate raster variable with values in the range [0,1].
Area covered by mosaic polygons was divided evenly among the constituent types.
We excluded the "tree plantation" ecosystem type from both analyses because some of the field campaigns did not register wildlings occurring within this type.

```{r locality-example, fig.cap='An illustration of one of the 82 plantation localities: Meaasen. The background map shows the surroundings of the plantation, and the 500x500 m plot is overlaid with an aerial photograph. The middle row of panels represents the data as registered in the field (NiN polygons not shown). The top and bottom rows of panels represent selected variables as they enter the regression model (with a spatial grain of 10 m).'}
knitr::include_graphics('figures/locality-example/locality-example.pdf')
```

For our first analysis, we calculated wildling density per ecosystem type across all localities, by dividing the total number of wildings in that type by the total area of that type.
Wildings in cells composed of multiple types were counted in proportion to cell's composition; for example, a cell with one wildling and half covered by a given type would tally 0.5 wildling for that type.

For our second analysis, we diagrammed causal relationships among the factors we hypothesized to influence the number of wildlings per cell with a directed acyclical graph (fig. \@ref(fig:DAG)).
In it, the unmeasured, proximate causes of wildling number (establishment probability and seed deposition, see eq. \@ref(eq:estmod)) are decendants of variables that we could observe or model. 
To estimate how ecosystem type affects wildlings, the directed acyclical graph guided us to specify statistical models with locality, climate, relative elevation, seed deposition density, and plantation age as covariates [@textorRobustCausalInference2016; @mcelreathHauntedDAGCausal2020].
It was was not strictly necessary to adjust for plantation age (with locality in the model), but we included it because it could reduce the unexplained variance associated with locality, and because our causal structure would allow us to interpret its estimate as an (unconfounded) total effect on wildling number [@westreichTableFallacyPresenting2013].
We represented climate as mean annual temperature (bio1) and precipitation of the coldest quarter (bio19), at 30-arcsecond resolution, from the CHELSA data product [@kargerClimatologiesHighResolution2017].
These two variables were chosen because they showed the strongest correlations with Norwegian vegetation zones and sections [@bakkestuenSteplessModelsRegional2008].
A grid cell's relative elevation was taken with respect to the highest point of the central plantation, from digital elevation models at 1 or 10 m resolution (Norwegian Mapping Authority).

```{r DAG, fig.cap="A directed acyclical graph showing the causal relationships that we use as our point of departure for a statistical model of ecosystem effect on wildling establishment. Red variables causally affect both the ecosystem type and wildling establishment, blue variables causally affect only wildling establishment, and grey variables are unobserved. Green arrows show the causal pathway of interest."}
knitr::include_graphics(here('ms', 'figures', 'dagitty-model.pdf'))
```

The response variable for our models --- number of wildlings --- showed a high frequency of zeros for all species.
We found that the best fitting negative binomial distribution consistently underestimated the number of zeros observed.
Accordingly, we applied zero-inflated generalized linear models, modeling zeros as the mixed product of a binomial process and a count process.

# Results

- Caution against drawing conclusions about the overall invasiveness of species from the comparison of establishment probabilities. The comparison is done for a particular plantation age, under particular climatic conditions, with a particular amount of seed rain --- all of which may vary systematically between species. For example, most lodgepole pine plantations are planted inland but the comparison is under a more oceanic climate, which increases its predicted rate of establishment. Similarly, *Larix* seeds have a higher terminal velocity than *P. abies* and therefore are unlikely to travel as far, but our comparison is at an equal density of seed deposition.

# Discussion

In the results from the naive approach, variation in the density of wildlings is partly attributable to differences between species and between ecosystem types, and partly to contingent properties of our sample, such as the spatial distribution of ecosystem types around plantations.
For example, if a particular ecosystem type tended to occur close to plantations, it would likely show higher wildling density than other ecosystem types even if the species were equally likely to establish there.

Advantage to observational study (registering established individuals rather than doing seeding plots) is that seeds experience only natural conditions, and it measures long-term survival --- the quantity of interest for management.

Advantage: 
Compared to tallying analysis, we see that the magnitudes of differences between ecosystem types is much larger. For management the difference between a ten-fold gap and a 1000-fold gap matters --- and may draw more attention to plantation surroundings.

Limitation:
Spatial grain. Minimum polygon area NiN, wildling group locations. A good reason to use a relatively course observation units (100 m2) and to perform fuzzy coding of ecosystem types.

Limitation:
WALD model of seed deposition fits patterns of *establishment* better than ExP, but we cannot strictly test if it was a better descriptor of seed dispersal specifically. See different definitions of seed dispersal kernel in Nathan. What processes other than dispersal could give WALD a better fit to establishment than ExP?   
- Negative density dependence, since the WALD model gave a more evenly spread probability distribution. If this is the case, it would mean that our results overestimate establishment probability near the seed sources and underestimate further away.  

# Appendix

## A1

```{r load localities-table, include=FALSE}
locs <- read_csv(here('output', 'localities-modified.csv')) # see 'wildlings-NiN.Rmd'
locs <- locs %>% 
  select(year.registered, reference, species, 
         locality, utm33.easting, utm33.northing,
         height.source, age, bio01, bio19,
         height.interpolated, age.interpolated) %>% 
  arrange(year.registered, reference, species) %>% 
  select(-year.registered)
# Formating
locs <- locs %>% 
  mutate(species = case_when(
    species == "P.contorta" ~ "Pinus contorta",
    species == "P.sitchensis-lutzii" ~ "Picea sitchensis / lutzii",
    species == "P.abies" ~ "Picea abies",
    species == "Larix" ~ "Larix spp.")) %>% 
  mutate(locality = paste(toupper(substring(locality, 1, 1)), 
                          substring(locality, 2), sep = "")) %>%
  mutate_at(c("utm33.easting","utm33.northing"), round) %>% 
  mutate_at(c("bio01","bio19"), ~ round(./10, digits = 2)) %>% 
  rename(`species group` = species, easting = utm33.easting, northing = utm33.northing,
         height = height.source)
# Footnotes
names(locs)[8] <- paste0(names(locs)[8], footnote_marker_alphabet(1))
names(locs)[9] <- paste0(names(locs)[9], footnote_marker_alphabet(2))
locs <- locs %>% 
  mutate_at(c("height","age"), as.character) %>% 
  mutate(height = case_when(
    height.interpolated ~ paste0(height, footnote_marker_symbol(1)),
    TRUE ~ height)) %>% 
  mutate(age = case_when(
    age.interpolated ~ paste0(age, footnote_marker_symbol(2)),
    TRUE ~ age)) %>% 
  select(-height.interpolated, -age.interpolated)
```

```{r localities-table}
kable(locs, escape = FALSE, align = "lllrrrrrr") %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(2, italic = TRUE) %>%
  footnote(general = "Easting and Northing are given for UTM zone 33N. Height is given in meters and age in years.",
           alphabet = c("mean annual temperature (°C)",
                        "precipitation in coldest quarter (cm)"),
           symbol = c("interpolated as the mean height of other plantations of the same species, inversely weighted by difference in age",
                      "interpolated as the mean age of other plantations of the same species in the same region"))
```

## A2

```{r recreate traits-table, include=FALSE}
traits <- tribble(
  ~`species group`, ~`seed terminal velocity`, ~`dispersal season`, ~references,
  "Larix spp.", 1.0, "Dec - May", "2, 3",
  "Picea abies", 0.58, "Nov - May", "2, 4",
  "Pinus contorta", 0.82, "Sep - Dec", "2",
  "Picea sitchensis / lutzii", 0.94, "Oct - Feb", "1, 2")
```

```{r traits-table}
kable(traits, escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(1, italic = TRUE) %>%
  footnote(general = c("1. Harris, A. S. Sitka spruce. in Silvics of North America: 1. Conifers (eds. Burns, R. M. & Honkala, B. H.) vol. 2 513–529 (U.S. Department of Agriculture, Forest Service, 1990).",
                       "2. Sandvik, H. Kunnskapsstatus for spredning og effekter av fremmede bartrær på biologisk mangfold. (2012).",
                       "3. Sullivan, J. Larix decidua. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/lardec/all.html (1994).",
                       "4. Sullivan, J. Picea abies. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/picabi/all.html (1994)."), 
            general_title = "References: ")
```

## A3

```{r make types table, include=FALSE}
pairing <- read_csv(here('data','codetype-pairing.csv'))
types <- read_csv(here('data', 'types.csv'))
typestab <- inner_join(types, pairing) %>%
  filter(!grepl(pattern = '.', x = .data$code, fixed = TRUE)) %>% 
  select(type = name, code, category, structuring, `vegetation height` = vegheight)
# Footnotes
names(typestab)[5] <- paste0(names(typestab)[5], footnote_marker_alphabet(1))
```

```{r types table}
options(knitr.kable.NA = '')
kable(typestab, escape = FALSE) %>% 
  collapse_rows(columns = 1) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  footnote(alphabet = "approximate vegetation heights (meters) are used only to estimate wind turbulence")
```

## A4

Seed source polygons for which the species of interest only made up a fraction of the tree composition (Olsen et al. 2019, Appelgren 2018 ...) were used with their point source density adjusted accordingly. 'Mixed forest'
Seed source polygons identified as logged (Appelgren 2018 ...) were included as seed sources only if we could confirm that they were logged no earlier the decade prior to mapping, using time series of aerial photos.

## A5

```{r, message=FALSE}
Pstab <- read_csv(here('ms', 'tables', 'Ps-modelsummary.csv'))
Patab <- read_csv(here('ms', 'tables', 'Pa-modelsummary.csv'))
Ltab <- read_csv(here('ms', 'tables', 'L-modelsummary.csv'))
Pctab <- read_csv(here('ms', 'tables', 'Pc-modelsummary.csv'))
```

```{r}
kable(Pstab, align = 'clrrrr', caption = 'Picea sitchensis / lutzii') %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(Patab, align = 'clrrrr', caption = 'Picea abies') %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top") %>%
  footnote(general = "generalized Poisson family with overdispersion parameter 2.59")

kable(Ltab, align = 'clrrrr', caption = 'Larix') %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(Pctab, align = 'clrrrr', caption = 'Pinus contorta') %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")
```

# References

```{r sessionInfo}
capture.output(sessionInfo(), file="sessionInfo.txt")
```
