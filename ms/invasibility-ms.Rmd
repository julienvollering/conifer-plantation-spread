---
title: 'Accounting for seed rain reveals that particular ecosystems are much more vulnerable to alien conifer establishment than others, without easily generalizable patterns'
author:
- Julien Vollering^[julienvollering@gmail.com]
- et al.
bibliography: invasibility-ms.bib
output: 
  bookdown::html_document2:
    toc: true
    toc_float: true
always_allow_html: true
editor_options:
  chunk_output_type: console
link-citations: yes
csl: ecology.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, tidy=TRUE, tidy.opts = list(width.cutoff=60))
options(knitr.graphics.auto_pdf = TRUE)
library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
```

# ORCIDs

Julien Vollering: <https://orcid.org/0000-0002-7409-2898>

# Running head

Ecosystem invasibility to alien conifers

# Abstract


# Keywords

conifer, disturbance, invasibility, plantation, seed rain, Wald Analytical Long-distance Dispersal (WALD)

# Introduction

Plantations of alien conifers are widespread in Norway, as they are in many countries, and offspring from these plantations frequently establish in surrounding areas [@richardsonConifersInvasiveAliens2004].
In many instances these naturalized offspring --- or wildlings --- harm biodiversity and other values, so controlling their spread is prudent.
In particular, plantations contribute to the presence of alien conifers in protected areas, and generate substantial costs as a result [@mcconnachieEstimatingEffectPlantations2015].
Controlling wildlings protects plantation surroundings and prevents secondary, potentially invasive spread.
Accordingly, the European "Code of conduct on planted forest and invasive alien trees" stresses that containing alien species to the areas set aside for their cultivation is fundamental to good forestry practice [@brunduPlantedForestsInvasive2016].

How many wildlings are present and how far they are from the plantation varies a lot from site to site, even among conspecific plantations of similar age [@nygaardSpreadIntroducedSitka2017], which makes it harder to predict and manage their spread.
To understand the variation between sites, we need to consider both dispersal and establishment (where establishment denotes germination and survival), which jointly generate patterns of wildling spread.
For example, an area of low establishment likelihood close to the plantation can be masked by high seed rain there [@rougetInferringProcessPattern2003].
Site-level dispersal is affected by external factors governing a species' dispersal syndrome --- for instance wind exposure and site topography in the case of wind-dispersed species.
Likewise, site-level establishment is affected by biotic and abiotic conditions where seeds arrive.
Reducing establishment is of particular interest because it regulates wildling abundance directly (by comparison, reducing dispersal can only regulate wildling abundance through negative density dependence). 
Establishment is also generally easier to manipulate than dispersal, either directly through intervention or indirectly through site selection [@calvino-cancelaInvasivePotentialEucalyptus2013]. 
Seed rain must be accounted for to estimate germination/survival (establishment) [@catfordQuantifyingLevelsBiological2012] --- most plantation studies do not distinguish.
Note that seed rain in this context is analogous to the concept of propagule pressure for invasions. Usually propagule pressure refers to levels of introduction at continental scales, but the idea is the same --- it is a normalizing quantity (an exposure) for an observed establishment rate.

It is important to consider at what spatial scale variability in natural recruitment occurs. This may differ between species. If most variation occurs at the coarsest spatial scale, drivers that also vary at course scales, such as climate, are likely to be important. If variation between plantations is greater than variation between regions, climate and other coarse-scale factors are probably less important, and drivers that vary at the plantation scale are likely important. If more variation occurs around single plantations than between plantations, site characteristics (e.g. surrounding ecosystem types) are likely the most important governing factors. 

To better understand which factors govern naturalized spread, we need to know how seeds are dispersed from plantations, and which landing site conditions promote or inhibit establishment. 

Therefore, the number of wildlings in the surroundings of a plantation is a function of the seed shadow from the plantation and the environmental characteristics of the proximal area.
Note that the seed shadow is not purely a function of plantation characteristics; plantation surroundings also affect the seed shadow.  
For example, lower elevations may trap more seeds.

Argument:
Managers aim to limit wildling spread from plantations
  - large observed variation: in abundance and spatial distribution
Process of spread: dispersal, germination, survival
  - dispersal must be accounted for to estimate germination/survival (establishment), most plantation studies do not distinguish.
  - establishment will differ based on local ecological conditions: abiotic and biotic factors
  - expected from literature and observed in field
  - hydrology / climate
  - nursing / competition
  - disturbance
Ecosystem types systematize local ecological conditions and are also a working unit of land management in Norway.
  - a tool for generalization (because systematic) and projection (because objective / transferable)
  - more similar types should show more similar establishment
  - useful to prioritize control and plan future plantations
  - in addition to ecosystem types, climate and topography are convenient and common considerations for managers to apply in their decision-making process. 
  
Determining which ecosystems are most vulnerable so that intervantions can be prioritized objectively is among the most urgent objectives for invasion science [@pysekScientistsWarningInvasive2020].
Widespread plantations of wind-dispersed conifers present an opportunity to quantify ecosystem invasibility robustly, by accounting for exposure (seed rain) directly, rather than by proxy [@catfordQuantifyingLevelsBiological2012]. 
Extensive
LDD less important
  
RQs:  
1. In which ecosystem types are wildlings from plantations of alien conifers most and least likely to establish?  
2. Can overarching characteristics of ecosystem types be used to generalize patterns of wildling establishment?  
3. Beyond their influence on ecosystem type, how do climate and topography affect the likelihood of wildling establishment?

# Methods

## Approach

We compared the frequency with which four groups of alien conifer species establish in various ecosystem types, using observational data.
Specifically, we used maps of wildlings and ecosystem types around the plantations from which the wildlings likely originated.
The groups of species (hereafter: "species") we examined were: (1) Sitka spruce (*Picea sitchensis*) together with its fertile hybrid, Lutz spruce (*Picea* x *lutzii*), (2) Norway spruce (*Picea abies*), (3) undetermined larches (*Larix* spp.), and (4) lodgepole pine (*Pinus contorta*). 

For each of the species, we analysed establishment frequency in two ways.
Our first analysis simply tallied of the number of wildlings per unit area for each ecosystem type.
The motivation for this naive approach was descriptive; we summarized the state of wildling establishment from the plantations in the sample.
Our second analysis was designed to isolate the influence of ecosystem types on establishment probability.
To do so, we defined establishment probability $E$ as the ratio of wildlings $W$ to deposited seeds $S$ in a given area, or:

\begin{equation} 
W_{xy} 	= S_{xy} * E_{xy}
(\#eq:estmod)
\end{equation}

where xy denotes a unit area.
This simple conceptual model mirrors our basic mechanistic understanding of the spread process: seeds disperse from their source to a given location ($S_{xy}$), and then the conditions at that location ($E_{xy}$) determine the likelihood that the seed establishes as a wildling ($W_{xy}$).
Guided by this equality, we specified a statistical model for the relationship between wildlings and ecosystem types, conditioning on estimates of $S_{xy}$.


## Field data

We observed wildlings and ecosystem types around 82 plantations across Norway (fig. \@ref(fig:localities-map)).
The sample comprised forty-two localities with Sitka/Lutz spruce, nineteen with Norway spruce, fifteen with larch, and six with lodgepole pine.
Note that the plantations of Norway spruce were located in parts of Norway where it is not considered native [@aarrestadForeignNorwaySpruce2014].
We selected and delineated plantations manually --- using aerial imagery --- aiming for plantations that were isolated from other plantations of the same species.
Furthermore, only plantations with cone-bearing individuals were included in the sample.
We collected the field data from each plantation in one of six field campaigns during the period 2016-2019 [reported in @olsenKartleggingAvKortdistansespredning2016; @appelgrenKartleggingAvKortdistansespredning2017; @kyrkjeeideKartleggingAvKortdistansespredning2017; @appelgrenKartleggingAvKortdistansespredning2018; @olsenKartleggingAvKortdistansespredning2019; @sandvenKartleggingAvKortdistansespredning2019].

```{r localities-map, fig.cap='Locations across Norway of the 82 plantations in the data set.'}
knitr::include_graphics('figures/localities-map.pdf')
```

In the field, wildlings and ecosystem types were mapped comprehensively within a 500x500 m plot centered around the plantation of interest.
Except in the 2016 field campaign, we also mapped as polygons any additional plantations of the same species within a larger 2x2 km plot.
We used GPS to register the point-positions of all wildlings over 30 cm in height, recording a single position for groups of wildlings occurring with less than 5 m between them.
A few exceptionally dense groups of wildlings were mapped by registering polygons instead of points and estimating the number of individuals by transect counts.
Concurrently, we registered polygons for all terrestrial ecosystem types, following the Nature in Norway classification system [version 2.0 or 2.1, @halvorsenNaturNorgeNiN2015].
The Nature in Norway system is the national standard for land cover mapping and provides full spatial coverage (i.e. any location and any kind of land cover is assignable to an ecosystem type).
It builds on the continuum concept in ecology, aiming for reproducible and value-neutral classification of ecosystems by rule-based discretization of species turnover along important environmental gradients [@austinContinuumConceptOrdination1985; @NatureTypesNorway2018; @whittakerGradientAnalysisVegetation1967].
We mapped ecosystem types at a scale of 1:5000, which implies that all polygons with a size over 250 m^2^ were registered [@brynVeilederKartleggingAv2015].
Regularly patterned occurrence of more than one ecosystem type in polygons smaller than the minimum size were registered as so-called mosaic polygons.

Some non-spatial data were also collected for each of the central plantations. 
We measured the height of a representative individual in the plantation by clinometer.
We also estimated the age of the plantation at the time of the field campaign, either by contacting land owners or municipal officials, or by counting growth rings.
Details for all 82 plantations are provided in Appendix [A1].

## Seed dispersal

For our second analysis --- isolating the effect of ecosystem type on establishment probability --- we needed estimates of the spatial distribution of seed deposition within the 500x500 m field plots.
Because conspecific plantations were sometimes located nearby the central plantation, we considered all plantations within a 1 km radius to be potential seed sources.
We used two models of seed dispersal to derive two different estimates of seed deposition probability density.

The first model was an empirical seed dispersal location kernel [@nathanDispersalKernels2012], with parameter estimates generalized from multiple data sets.
Specifically, we selected from Bullock et al. [-@bullockSynthesisEmpiricalPlant2017] the kernel that performed best for wind-adapted seeds from 5-15 m tall trees (an Exponential Power function).
Seventy-two of the 82 plantations in our data set matched this height range better than a taller height range with a different empirical kernel.

The second model was mechanistic, using local wind velocity and direction to parameterize the Wald Analytical Long-distance Dispersal [WALD, @katulMechanisticAnalyticalModels2005] model in different directions from seed sources [following @skarpaasDispersalPatternsDispersal2007].
The WALD model takes the form of an inverse Gaussian distribution whose mean ($\mu$) and shape ($\lambda$) parameters are calculated from physical characteristics of the dispersal system:
$$\mu  = \frac{HU}{F}$$
$$\lambda = \left(\frac{H}{\sigma}\right)^2$$
where $H$ is the seed release height, $U$ is the mean horizontal wind velocity between $H$ and the ground, $F$ is the terminal velocity of the seed, and $\sigma$ is a wind turbulence parameter.
We set $H$ to the height of the central plantation, estimated $U$ from a computed vertical wind profile, obtained $F$ from literature (Appendix [A2]), and calculated $\sigma$ from an equation for turbulent flow as a function of vegetation height [@skarpaasDispersalPatternsDispersal2007, eq. A4].
We parameterized separate WALD models for 20º sectors around each seed source, to make seed dispersal anisotropic (directional).
In each sector we estimated mean vegetation height based on the composition of mapped ecosystem types (Appendix [A3]).
Simulataneously, we randomly sampled 100 wind velocities in the direction of the sector during the species' dispersal season (Appendix [A2]).
The 100 resulting WALD kernels produced the seed probability density in the sector, and individual sectors were weighed by the frequency of corresponding wind directions (again, during the species' dispersal season).
The wind data were obtained either from the nearest weather station (MET Norway), a 2.5 km resolution interpolated hindcast covering southern Norway [@haakenstad15yearHighResolution2017], or a 10 km resolution hindcast covering all of Norway [@reistadHighresolutionHindcastWind2011; @haakenstadNORA10EIRevisedRegional]. We used weather station data if the station was less than 2.5 or 10 km away (depending on hindcast coverage), or else the highest resolution hindcast.

Both estimates of seed deposition were expressed on a grid with a grain of 10 m, so dispersal kernels were applied to the distance from seed source to grid cell center. 
Field-mapped polygons of seed sources were transformed into hexagonally gridded point sources, with a density of 0.1 m^-2^ for the first model and 0.01 m^-2^ for the second model (to reduce computation time). 
Additional details about how data from different field campaigns were harmonized to model seed dispersal are explained in Appendix [A4].

## Establishment

For our analyses of establishment, we rasterized wildling occurences and ecosystem types to the same 10 m grid as the seed dispersal models (fig. \@ref(fig:locality-example)). 
Rather than assigning a single ecosystem type to each grid cell, we applied fuzzy logic and assigned ecosystem types in proportion to their areal coverage of the cell.
In other words, each ecosystem type was rendered as a separate raster variable with values in the range [0,1].
Area covered by mosaic polygons was divided evenly among the constituent types.
We excluded the "tree plantation" ecosystem type from both analyses because some of the field campaigns did not register wildlings occurring within this type.

```{r locality-example, fig.cap='An illustration of one of the 82 plantation localities: Meaasen. The background map shows the surroundings of the plantation, and the 500x500 m plot is overlaid with an aerial photograph. The middle row of panels represents the data as registered in the field (NiN polygons not shown). The top and bottom rows of panels represent selected variables as they enter the regression model (with a spatial grain of 10 m). Grid cells without data are either seed sources (corresponding to the polygons shown) or tree plantations of other species (such as one along the road).'}
knitr::include_graphics('figures/locality-example/locality-example.pdf')
```

For our first analysis, we calculated wildling density per ecosystem type across all localities, by dividing the total number of wildings in that type by the total area of that type.
Wildings in cells composed of multiple types were counted in proportion to cell's composition; for example, a cell with one wildling and half-covered by a given type would tally 0.5 wildling for that type.

For our second analysis, we used a directed acyclical graph (DAG) to diagram causal relationships among the factors we expected to influence the number of wildlings per cell (fig. \@ref(fig:DAG)).
We included an effect of relative elevation on seed deposition because our implementation of the WALD model does not capture potential parameter changes induced by uneven terrain [@katulEffectsGentleTopographic2012].   
In the DAG, the unmeasured, proximate causes of wildling number --- establishment probability and seed deposition, see eq. \@ref(eq:estmod) --- are decendants of variables that we could observe or model.
To estimate the causal influence of ecosystem type on wildlings, the directed acyclical graph dictated that we adjust for locality, climate, relative elevation, and seed deposition in our regression model [@textorRobustCausalInference2016; @mcelreathHauntedDAGCausal2020].
We did not need to adjust for plantation age (with locality in the model), but we included it as a covariate anyway because it could reduce the unexplained variance associated with locality, and because our assumed causal structure would allow us to interpret its coefficient as an (unconfounded) total effect on wildling number [@westreichTableFallacyPresenting2013].
Climate entered the regression model as mean annual temperature (Bio1) and precipitation of the coldest quarter (Bio19), at 30-arcsecond resolution, from the CHELSA data product [@kargerClimatologiesHighResolution2017].
We chose these two variables because they showed the strongest correlations with Norwegian vegetation zones and sections [@bakkestuenSteplessModelsRegional2008].
Relative elevation was taken with respect to the highest point of the central plantation, from digital elevation models at 1 or 10 m resolution (Norwegian Mapping Authority).
Lastly, plantation surroundings are likely to experience large stochastic variation in annual seed depostion, because seed release will concide with different wind conditions from year to year.
Therefore we also included in our model the first order interaction between seed deposition and plantation age.

```{r DAG, fig.cap="A directed acyclical graph showing the causal relationships that we use as our point of departure for a statistical model of ecosystem effect on wildling establishment. Red variables causally affect both the ecosystem type and wildling establishment, blue variables causally affect only wildling establishment, and grey variables are unobserved. Green arrows show the causal pathway of interest."}
knitr::include_graphics(here('ms', 'figures', 'dagitty-model.pdf'))
```

For all species, the number of wildlings per cell showed a high frequency of zeros that was underestimated by the best fitting negative binomial distribution.
Accordingly, we applied zero-inflated, negative binomial (ZINB) generalized linear models.
These regard zeros as the mixed product of a binomial process as well as a (conditional) count process.
We modeled the binomial process as dependent on plantation age and locality. 
We expected that younger plantations would exhibit more cells without wildlings than predicted under a constant rate of colonization, because of their infertile juvenile period.
We also expected the frequency of zeros to vary with locality, because our field work documented that some land owners had occasionally made efforts to remove wildlings.
Excess zeros that arose in these ways would therefore not bias our estimates of establishment probability [@blasco-morenoWhatDoesZero2019].
To summarize, we modeled:

\begin{equation}
wildings_{ij} \sim ZINB(\pi_{ij}, \mu_{ij}, \phi) \\
logit(\pi_{ij}) = PlantationAge_{ij} + Locality_{ij} \\
log(\mu_{ij}) =  + \sum\limits_{k=1}^K EcosystemType_{ijk} + Locality_{i} + Bio1_{ij} + Bio19_{ij} + RelativeElevation_{ij} + \\
SeedDeposition_{ij} + PlantationAge_{ij} + SeedDeposition_{ij} \cdot PlantationAge_{ij}  \\
Locality_{i} \sim Normal(0, \sigma^2) \\
(\#eq:statmod)
\end{equation}

where $\pi$ is the probability of a zero from the binomial process, while $\mu$ and $\phi$ are the mean and dispersion of the negative binomial distribution, respectively [eq. 11.21 in @zuurZeroTruncatedZeroInflatedModels2009]. 
Subscripts $i$, $j$, and $k$ index localities, cells, and ecosystem types.

We standardized variables (except ecosystem types, which were [0,1]) and fitted models with the glmmTMB package [version 1.0, @brooksGlmmTMBBalancesSpeed2017] in R [version 3.6, @rcoreteamLanguageEnvironmentStatistical2020].
For each species we dropped ecosystem types that were completely free of wildlings (to avoid model convergence issues stemming from complete separation).
We fitted parallel models for our two seed deposition variables and selected the model with the better AIC.
To catch problems with our model specification, we looked for deviation from uniformity in quantile-scaled, simulated residuals, using the DHARMa package [version 0.2.7, @hartigDHARMaResidualDiagnostics2020].
We also ran DHARMa's tests for residual over/underdispersion and zero-inflation.
The Norway spruce model showed residual underdispersion, so we replaced the negative binomial distribution with the generalized Poisson distribution, which solved the issue [@brooksStatisticalModelingPatterns2019].
Futhermore, the lodgepole pine model did not converge as specified.
To achieve convergence we dropped locality from the binomial submodel, as its variance was likely difficult to estimate from only six localities.

Relative establishment probabilities of ecosystem types were calculated as predictions from the conditional part of the zero-inflation model (holding covariates at their mean values), scaled by the predicted value for a reference ecosystem type.
To help summarize patterns in establishment probability among ecosystem types, we aggregated ecosystem types by category (terrestrial or wetland) and structuring process (anthrogenic, natural or no disturbance) and obtained estimates for these strata from refitted models that were otherwise unchanged.

# Results

The total, unstratified density of wildings in our data set was 28/ha for Sitka/Lutz spruce, 6/ha for Norway spruce, 13/ha for larch, and 34/ha for lodgepole pine.
Observed wildlings densities in different ecosystem types --- excluding ecosystem types covering less than 1 ha --- ranged 1-60/ha for Sitka spruce, 0-49/ha for Norway spruce, 0-52/ha for larch, and 0-219/ha for lodgepole pine.
The "open active landslide" type exceeded these densities around Sitka/Lutz spruce and larch plantations, but was very rare.

Modeled establishment probabilities among ecosystem types tallying at least one wildling and covering at least 1 ha varied by up to five orders of magnitude (fig. \@ref(fig:relative-establishment)).
Wildling densities calculated directly from the data revealed less variation in establishment probability between ecosystem types --- they were closer to the overall mean --- than the corresponding modeled estimates.
Within species, confidence intervals on modeled establishment probabilities in pairs of ecosystem types frequently overlapped.
Nevertheless, establishment probability in many other ecosystem types could be distinguished with a high degree of confidence.
For example, it is not clear whether the establishment probability of lodgepole pine was higher in the "coastal heath" or "bare rock" types, but it was clearly much higher in both of these than in "forest".
The pattern of establishment probability among ecosystem types was modestly similar between species, with positive rank correlations in four of six species pairs (tab. \@ref(tab:correlation-table)).

Establishment probabilities varied strongly among Sitka/Lutz spruce localities, such that it swamped much of the variation between ecosystem types. 
For example, the model predicted that "arable fields" at the locality with the highest overall establishment probability and "boreal heath" at the locality with the lowest overall establishment probability would be colonized at roughly equal rates, even though "boreal heath" is colonized more than 100 times faster on average.
For the other species, especially for Norway spruce and lodgepole pine, there was much less variation in establishment probabilities among localities. 

```{r relative-establishment, fig.cap="Relative establishment probabilities among ecosystem types, using 'forest' as the reference level, for four alien conifer species groups. Unfilled points show scaled wildling densities calculated directly from the data. In the case of zero wildlings, these points are placed at the lower limit of the x-axis. Filled points with line intervals show modeled estimates surrounded by their 95 % confidence intervals. Grey point clouds show modeled estimates for individual localities. Ecosystem types are ordered by a confidence-weighted mean of their percentile-ranked establishment probabilities within species, such that types with consistently high establishment probability across species are at the top of the y-axis. Ecosystem types shown in italic font are wetlands, and ecosystem types shown in bold font are characterized by disturbance. Ecosystem types without wildlings and covering less than 0.5 ha across all localities for that species are not displayed. Photos licensed CC BY 4.0 Rune Halvorsen."}
knitr::include_graphics(here('ms', 'figures', 'relative-establishment', 'relative-establishment.pdf'))
```

```{r correlation-table}
cortab <- read.csv(here('ms', 'tables', 'spearman-corr.csv'), 
                   row.names = 1, check.names = FALSE)
cortab[lower.tri(cortab, diag = TRUE)] <- ""
cortab <- cortab[-4,-1]
knitr::kable(cortab, 
             caption = "Rank correlations of relative establishment probabilities in ecosystem types, between pairs of species.") %>%
  kable_styling(full_width = F)
```

Naturally, the variation in establishment probabilities shrank when we used category or structuring process to aggregate ecosystem types (fig. \@ref(fig:relative-establishment-hypotheses)).
No more than two orders of magnitude separated establishment probabilites of these different groupings.
Despite larger sample sizes, many of the groupings were not distinguishable with high confidence.
Sitka/Lutz spruce and Norway spruce established at higher rates in wetland ecosystem types than terrestial ecosystem types, while the opposite was true for larch and lodgepole pine.
Sitka/Lutz spruce and Norway spruce also colonized ecosystem types without disturbance-structuring on par with or at a higher rate than disturbance-structured ecosystem types.
For larch and lodgepole pine, structuring by natural distubance and anthropogenic disturbance, respectively, were associated with the highest rates of colonization. 

```{r relative-establishment-hypotheses, fig.cap="Relative establishment probabilities among categories of ecosystem types (top) or structuring processes in ecosystem types (bottom), for four alien conifer species groups. Unfilled points show scaled wildling densities calculated directly from the data. Filled points with line intervals show modeled estimates surrounded by their 95 % confidence intervals. The scale of the x-axis differs by species group and the horizontal dotted line marks the reference level for the comparison."}
knitr::include_graphics(here('ms', 'figures', 'relative-establishment-hypotheses.pdf'))
```

The direct effect of climate on establishment --- not including its effect mediated by ecosystem types --- was negligible for Sitka/Lutz spruce and Norway spruce, with model estimates near zero (Appendix [A5]). 
For larch there was a negative direct effect of precipitation (Bio19), with a 50 mm increase in coldest-quarter precipitation estimated to decrease establishment six-fold.
From the six sites with lodgepole pine, the model estimated a very strong negative direct effect of annual temperature (Bio01), with a drop of 2.3 ºC decreasing establishment by five orders of magnitude.
It also estimated a strong positive effect of precipitation (Bio19), with a 175 mm increase in coldest-quarter precipitation increasing establishment 500 times.
The direct effect of relative elevation on establishment --- not including its effect mediated by ecosystem types --- was modest and acted in different directions for different species.
For all species, estimates of seed deposition derived from the WALD model of seed dispersal fit patterns of wildling establishment better than estimates derived from the generalized seed dispersal kernel that we tested.
There was a high degree of confidence that the effect of relative seed deposition was positive for all species.
The 95 % confidence intervals around plantation age effects included zero in all cases except in the binomial submodels for Sitka/Lutz spruce and larch (where older plantations showed fewer zeros).
The interaction specified between seed deposition and plantation age was estimated to be positive for Sitka/Lutz spruce, nonexistent for Norway spruce, and negative for larch and lodgepole pine.

# Discussion

Compare results to other assessments of ecosystem invasibility to conifers [@richardsonPineInvasionsSouthern1994; @fernandesNaturalRegenerationPinus2016; @vanettenInvasionPatternsPinus2020] or to plants more broadly [@chytryHabitatInvasionsAlien2008; @calvino-cancelaInvasivePotentialEucalyptus2013].

1. Two obvious management recommendations: 1) for site selection, try to limit plantations to sites where they are surrounded by arable fields. Where it is simultanueosly desireable to alter adjacent nature types (e.g. by grazing), that is also an option. 2) For early detection and rapid response, prioritize monitoring and control interventions in vulnerable ecosystem types like... 5500 km2 mapped for ecosystem types in Norway.

2. The fact that disturbance events promote invasion does not map directly to ecosystems characterized by distubance being at higher risk than ecosystems not characterized by disturbance. Or, more broadly, invasion patterns of alien conifers frequently clash with our a priori expectations based on their autecology and general tenets of invasion ecology.
Our disturbance results should not be interpreted to mean that an anthropogenic disturbance event decreases establishment probability relative to prior state (e.g. [@vikaneInvasionCallunaHeath2013] shows that burning in coastal heathland increases Sitka spruce establishment), but that alien conifers are not as likely to establish in anthropogenically disturbed ecosystems --- including ecosystems like arable fields --- as a group. An obvious explanation for this pattern is that these kinds of disturbance regimes kill as many or more wildlings than they recruit [@buckleyDisturbanceInvasionReinvasion2007].

3. Beware that Sitka colonization varies enormously from site to site --- much more than other species --- so our ability to predict the magnitude of spread at a specific site is limited. More research is needed to probe this unexplained variance (human action?). But that does not mean we cannot or should not use the estimates to guide management! For example, imagine one locality consists entirely of coastal heath and another entirely of arable field. All things being equal, we expect the coastal heath locality to be colonized more than 100 times faster than the arable field locality. Simultaneusly we should not be surprised if they are colonized at equal rates.


Caution: do not draw conclusions about the overall invasiveness of species from the comparison of establishment probabilities. The comparison is done for a particular plantation age, under particular climatic conditions, with a particular amount of seed rain --- all of which may vary systematically between species. For example, most lodgepole pine plantations are planted inland but the comparison is under a more oceanic climate, which increases its predicted rate of establishment. Similarly, *Larix* seeds have a higher terminal velocity than *P. abies* and therefore are unlikely to travel as far, but our comparison is at an equal density of seed deposition.

Advantage: establishment patterns are likely to hold in other countries [@chytryHabitatInvasionsAlien2008]. Because the typification system we used is rule-based and aims to be observer-neutral, land managers in other countries can make educated inferences based on our results, even if a compatible or similar typication system does not exist. For example...

Advantage: observational study (registering established individuals rather than doing seeding plots) is that seeds experience only natural conditions, and it measures long-term survival --- the quantity of interest for management. For practical reasons, seeding studies observe only the youngest life-stages, and the factors controlling individual success likely differ at later life-stages [@dovciakSeedRainEnvironmental2008]. Therefore, their results are not directly applicable to spread on the longer time-scales of interest to managers.

In the results from the naive approach, variation in the density of wildlings is partly attributable to differences between species and between ecosystem types, and partly to contingent properties of our sample, such as the spatial distribution of ecosystem types around plantations.
For example, if a particular ecosystem type tended to occur close to plantations, it would likely show higher wildling density than other ecosystem types even if the species were equally likely to establish there.
Advantage: compared to tallying analysis, we see that the magnitudes of differences between ecosystem types is much larger. For management the difference between a ten-fold gap and a 1000-fold gap matters --- and may draw more attention to plantation surroundings.

Limitation: spatial grain. Minimum polygon area NiN, wildling group locations. A good reason to use a relatively course observation units (100 m2) and to perform fuzzy coding of ecosystem types. Did our best to represent ecotones in the models and not use polygon boundaries overconfidently.

Limitation: WALD model of seed deposition fits patterns of *establishment* better than ExP, but we cannot strictly test if it was a better descriptor of seed dispersal specifically. See different definitions of seed dispersal kernel in Nathan. What processes other than dispersal could give WALD a better fit to establishment than ExP?   
- Negative density dependence, since the WALD model gave a more evenly spread probability distribution. If this is the case, it would mean that our results overestimate establishment probability near the seed sources and underestimate further away.  

Limitation: inland versus coastal P.contorta sites. Number of wildlings, climate...

Limitation: wildling establishment varies not only in number and distance but also in growth rate across ecosystem types. Abundant but slow colonization may be of lesser concern than sparse but fast colonization, depending on management objectives.

Caution: our models do not estimate the *total* causal effect of climate or relative elevation on wildlings.
The reason is that each has a causal relationship to wildling number that passes through ecosystem type, which we have adjusted for in our models [@westreichTableFallacyPresenting2013].
Instead, our models estimate the *direct* effects of climate (through establishment probability alone) and of relative elevation (through seed deposition alone).   
This distinction means that their estimates should not be used guide management directly.
For example, using the climate coefficients (alone) to project risk of wildling establishment across Norway would assume a uniform distribution of ecosystem types everywhere.
Rather, we can interpret their results with respect to specific mechanisms.
Wet and warm conditions...
Locations above plantations...

Similar methods can be applied to non-conifer plantations that show large site-level variation [e.g. @fernandesWhatDrivesEucalyptus2018].
Wildling spread from plantations is a growing problem [@richardsonConifersInvasiveAliens2004] and is likely to accelerate with recent pushes to increase tree planting worldwide. 

# Appendix

## A1

```{r load localities-table, include=FALSE}
locs <- read_csv(here('output', 'localities-modified.csv')) # see 'wildlings-NiN.Rmd'
locs <- locs %>% 
  select(year.registered, reference, species, 
         locality, utm33.easting, utm33.northing,
         height.source, age, bio01, bio19,
         height.interpolated, age.interpolated) %>% 
  arrange(year.registered, reference, species) %>% 
  select(-year.registered)
# Formating
locs <- locs %>% 
  mutate(species = case_when(
    species == "P.contorta" ~ "Pinus contorta",
    species == "P.sitchensis-lutzii" ~ "Picea sitchensis / lutzii",
    species == "P.abies" ~ "Picea abies",
    species == "Larix" ~ "Larix spp.")) %>% 
  mutate(locality = paste(toupper(substring(locality, 1, 1)), 
                          substring(locality, 2), sep = "")) %>%
  mutate_at(c("utm33.easting","utm33.northing"), round) %>% 
  mutate_at(c("bio01","bio19"), ~ round(./10, digits = 2)) %>% 
  rename(`species group` = species, easting = utm33.easting, northing = utm33.northing,
         height = height.source)
# Footnotes
names(locs)[8] <- paste0(names(locs)[8], footnote_marker_alphabet(1))
names(locs)[9] <- paste0(names(locs)[9], footnote_marker_alphabet(2))
locs <- locs %>% 
  mutate_at(c("height","age"), as.character) %>% 
  mutate(height = case_when(
    height.interpolated ~ paste0(height, footnote_marker_symbol(1)),
    TRUE ~ height)) %>% 
  mutate(age = case_when(
    age.interpolated ~ paste0(age, footnote_marker_symbol(2)),
    TRUE ~ age)) %>% 
  select(-height.interpolated, -age.interpolated)
```

```{r localities-table}
kable(locs, escape = FALSE, align = "lllrrrrrr") %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(2, italic = TRUE) %>%
  footnote(general = "Easting and Northing are given for UTM zone 33N. Height is given in meters and age in years.",
           alphabet = c("mean annual temperature (°C)",
                        "precipitation in coldest quarter (cm)"),
           symbol = c("interpolated as the mean height of other plantations of the same species, inversely weighted by difference in age",
                      "interpolated as the mean age of other plantations of the same species in the same region"))
```

## A2

```{r recreate traits-table, include=FALSE}
traits <- tribble(
  ~`species group`, ~`seed terminal velocity`, ~`dispersal season`, ~references,
  "Larix spp.", 1.0, "Dec - May", "2, 3",
  "Picea abies", 0.58, "Nov - May", "2, 4",
  "Pinus contorta", 0.82, "Sep - Dec", "2",
  "Picea sitchensis / lutzii", 0.94, "Oct - Feb", "1, 2")
```

```{r traits-table}
kable(traits, escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  column_spec(1, italic = TRUE) %>%
  footnote(general = c("1. Harris, A. S. Sitka spruce. in Silvics of North America: 1. Conifers (eds. Burns, R. M. & Honkala, B. H.) vol. 2 513–529 (U.S. Department of Agriculture, Forest Service, 1990).",
                       "2. Sandvik, H. Kunnskapsstatus for spredning og effekter av fremmede bartrær på biologisk mangfold. (2012).",
                       "3. Sullivan, J. Larix decidua. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/lardec/all.html (1994).",
                       "4. Sullivan, J. Picea abies. Fire Effects Information System, U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station,  Fire Sciences Laboratory https://www.fs.fed.us/database/feis/plants/tree/picabi/all.html (1994)."), 
            general_title = "References: ")
```

## A3

```{r make types table, include=FALSE}
pairing <- read_csv(here('data','codetype-pairing.csv'))
types <- read_csv(here('data', 'types.csv'))
typestab <- inner_join(types, pairing) %>%
  filter(!grepl(pattern = '.', x = .data$code, fixed = TRUE)) %>% 
  select(type = name, code, category, structuring, `vegetation height` = vegheight)
# Footnotes
names(typestab)[5] <- paste0(names(typestab)[5], footnote_marker_alphabet(1))
```

```{r types table}
options(knitr.kable.NA = '')
kable(typestab, escape = FALSE) %>% 
  collapse_rows(columns = 1) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed")) %>% 
  footnote(alphabet = "approximate vegetation heights (meters) are used only to estimate wind turbulence")
```

## A4

Seed source polygons for which the species of interest only made up a fraction of the plantation composition [e.g. in @olsenKartleggingAvKortdistansespredning2019] were used with their point source density adjusted accordingly.
For example, a plantation identified as composed of Sitka spruce and Norway spruce was assigned a seed source point density half that of a pure Sitka spruce plantation.
Likewise, 'mixed forest' plantations [e.g. in @appelgrenKartleggingAvKortdistansespredning2018] were assigned 0.1 times the seed source point density of a pure plantation.  
Seed source polygons identified as logged [e.g. in @appelgrenKartleggingAvKortdistansespredning2018] were included as seed sources only if we could confirm that they were logged no earlier the decade prior to mapping, using time series of aerial photos.

## A5

```{r, message=FALSE}
Pstab <- read_csv(here('ms', 'tables', 'Ps-modelsummary.csv'))
Patab <- read_csv(here('ms', 'tables', 'Pa-modelsummary.csv'))
Ltab <- read_csv(here('ms', 'tables', 'L-modelsummary.csv'))
Pctab <- read_csv(here('ms', 'tables', 'Pc-modelsummary.csv'))
```

```{r}
kable(Pstab, align = 'clrrrr', caption = "Picea sitchensis / lutzii. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.253.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(Patab, align = 'clrrrr', caption = "Picea abies. Conditional model is glmmTMB's genpois family with dispersion parameter 2.59.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(Ltab, align = 'clrrrr', caption = "Larix. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.261.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")

kable(Pctab[-nrow(Pctab), ], align = 'clrrrr', caption = "Pinus contorta. Conditional model is glmmTMB's nbinom2 family with dispersion parameter phi = 0.0329.") %>%
  kable_styling() %>% 
  add_header_above(c(" " = 2, "Fixed effects" = 2, "Random effects" = 2)) %>% 
  column_spec(1, bold = T) %>% 
  collapse_rows(columns = 1, valign = "top")
```

# References

```{r sessionInfo}
capture.output(sessionInfo(), file="sessionInfo.txt")
```
